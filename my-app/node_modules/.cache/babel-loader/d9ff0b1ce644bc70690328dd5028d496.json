{"ast":null,"code":"/**\n * Module dependencies.\n */\n\nvar EventEmitter = require('events').EventEmitter;\nvar parser = require('engine.io-parser');\nvar util = require('util');\nvar debug = require('debug')('engine:transport');\n\n/**\n * Expose the constructor.\n */\n\nmodule.exports = Transport;\n\n/**\n * Noop function.\n *\n * @api private\n */\n\nfunction noop() {}\n\n/**\n * Transport constructor.\n *\n * @param {http.IncomingMessage} request\n * @api public\n */\n\nfunction Transport(req) {\n  this.readyState = 'open';\n  this.discarded = false;\n}\n\n/**\n * Inherits from EventEmitter.\n */\n\nutil.inherits(Transport, EventEmitter);\n\n/**\n * Flags the transport as discarded.\n *\n * @api private\n */\n\nTransport.prototype.discard = function () {\n  this.discarded = true;\n};\n\n/**\n * Called with an incoming HTTP request.\n *\n * @param {http.IncomingMessage} request\n * @api private\n */\n\nTransport.prototype.onRequest = function (req) {\n  debug('setting request');\n  this.req = req;\n};\n\n/**\n * Closes the transport.\n *\n * @api private\n */\n\nTransport.prototype.close = function (fn) {\n  if ('closed' === this.readyState || 'closing' === this.readyState) return;\n  this.readyState = 'closing';\n  this.doClose(fn || noop);\n};\n\n/**\n * Called with a transport error.\n *\n * @param {String} message error\n * @param {Object} error description\n * @api private\n */\n\nTransport.prototype.onError = function (msg, desc) {\n  if (this.listeners('error').length) {\n    var err = new Error(msg);\n    err.type = 'TransportError';\n    err.description = desc;\n    this.emit('error', err);\n  } else {\n    debug('ignored transport error %s (%s)', msg, desc);\n  }\n};\n\n/**\n * Called with parsed out a packets from the data stream.\n *\n * @param {Object} packet\n * @api private\n */\n\nTransport.prototype.onPacket = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called with the encoded packet data.\n *\n * @param {String} data\n * @api private\n */\n\nTransport.prototype.onData = function (data) {\n  this.onPacket(parser.decodePacket(data));\n};\n\n/**\n * Called upon transport close.\n *\n * @api private\n */\n\nTransport.prototype.onClose = function () {\n  this.readyState = 'closed';\n  this.emit('close');\n};","map":{"version":3,"names":["EventEmitter","require","parser","util","debug","module","exports","Transport","noop","req","readyState","discarded","inherits","prototype","discard","onRequest","close","fn","doClose","onError","msg","desc","listeners","length","err","Error","type","description","emit","onPacket","packet","onData","data","decodePacket","onClose"],"sources":["/home/user/Рабочий стол/pizza/project/node_modules/engine.io/lib/transport.js"],"sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar EventEmitter = require('events').EventEmitter;\nvar parser = require('engine.io-parser');\nvar util = require('util');\nvar debug = require('debug')('engine:transport');\n\n/**\n * Expose the constructor.\n */\n\nmodule.exports = Transport;\n\n/**\n * Noop function.\n *\n * @api private\n */\n\nfunction noop () {}\n\n/**\n * Transport constructor.\n *\n * @param {http.IncomingMessage} request\n * @api public\n */\n\nfunction Transport (req) {\n  this.readyState = 'open';\n  this.discarded = false;\n}\n\n/**\n * Inherits from EventEmitter.\n */\n\nutil.inherits(Transport, EventEmitter);\n\n/**\n * Flags the transport as discarded.\n *\n * @api private\n */\n\nTransport.prototype.discard = function () {\n  this.discarded = true;\n};\n\n/**\n * Called with an incoming HTTP request.\n *\n * @param {http.IncomingMessage} request\n * @api private\n */\n\nTransport.prototype.onRequest = function (req) {\n  debug('setting request');\n  this.req = req;\n};\n\n/**\n * Closes the transport.\n *\n * @api private\n */\n\nTransport.prototype.close = function (fn) {\n  if ('closed' === this.readyState || 'closing' === this.readyState) return;\n\n  this.readyState = 'closing';\n  this.doClose(fn || noop);\n};\n\n/**\n * Called with a transport error.\n *\n * @param {String} message error\n * @param {Object} error description\n * @api private\n */\n\nTransport.prototype.onError = function (msg, desc) {\n  if (this.listeners('error').length) {\n    var err = new Error(msg);\n    err.type = 'TransportError';\n    err.description = desc;\n    this.emit('error', err);\n  } else {\n    debug('ignored transport error %s (%s)', msg, desc);\n  }\n};\n\n/**\n * Called with parsed out a packets from the data stream.\n *\n * @param {Object} packet\n * @api private\n */\n\nTransport.prototype.onPacket = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called with the encoded packet data.\n *\n * @param {String} data\n * @api private\n */\n\nTransport.prototype.onData = function (data) {\n  this.onPacket(parser.decodePacket(data));\n};\n\n/**\n * Called upon transport close.\n *\n * @api private\n */\n\nTransport.prototype.onClose = function () {\n  this.readyState = 'closed';\n  this.emit('close');\n};\n"],"mappings":"AACA;AACA;AACA;;AAEA,IAAIA,YAAY,GAAGC,OAAO,CAAC,QAAQ,CAAC,CAACD,YAAY;AACjD,IAAIE,MAAM,GAAGD,OAAO,CAAC,kBAAkB,CAAC;AACxC,IAAIE,IAAI,GAAGF,OAAO,CAAC,MAAM,CAAC;AAC1B,IAAIG,KAAK,GAAGH,OAAO,CAAC,OAAO,CAAC,CAAC,kBAAkB,CAAC;;AAEhD;AACA;AACA;;AAEAI,MAAM,CAACC,OAAO,GAAGC,SAAS;;AAE1B;AACA;AACA;AACA;AACA;;AAEA,SAASC,IAAI,GAAI,CAAC;;AAElB;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASD,SAAS,CAAEE,GAAG,EAAE;EACvB,IAAI,CAACC,UAAU,GAAG,MAAM;EACxB,IAAI,CAACC,SAAS,GAAG,KAAK;AACxB;;AAEA;AACA;AACA;;AAEAR,IAAI,CAACS,QAAQ,CAACL,SAAS,EAAEP,YAAY,CAAC;;AAEtC;AACA;AACA;AACA;AACA;;AAEAO,SAAS,CAACM,SAAS,CAACC,OAAO,GAAG,YAAY;EACxC,IAAI,CAACH,SAAS,GAAG,IAAI;AACvB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEAJ,SAAS,CAACM,SAAS,CAACE,SAAS,GAAG,UAAUN,GAAG,EAAE;EAC7CL,KAAK,CAAC,iBAAiB,CAAC;EACxB,IAAI,CAACK,GAAG,GAAGA,GAAG;AAChB,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEAF,SAAS,CAACM,SAAS,CAACG,KAAK,GAAG,UAAUC,EAAE,EAAE;EACxC,IAAI,QAAQ,KAAK,IAAI,CAACP,UAAU,IAAI,SAAS,KAAK,IAAI,CAACA,UAAU,EAAE;EAEnE,IAAI,CAACA,UAAU,GAAG,SAAS;EAC3B,IAAI,CAACQ,OAAO,CAACD,EAAE,IAAIT,IAAI,CAAC;AAC1B,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAD,SAAS,CAACM,SAAS,CAACM,OAAO,GAAG,UAAUC,GAAG,EAAEC,IAAI,EAAE;EACjD,IAAI,IAAI,CAACC,SAAS,CAAC,OAAO,CAAC,CAACC,MAAM,EAAE;IAClC,IAAIC,GAAG,GAAG,IAAIC,KAAK,CAACL,GAAG,CAAC;IACxBI,GAAG,CAACE,IAAI,GAAG,gBAAgB;IAC3BF,GAAG,CAACG,WAAW,GAAGN,IAAI;IACtB,IAAI,CAACO,IAAI,CAAC,OAAO,EAAEJ,GAAG,CAAC;EACzB,CAAC,MAAM;IACLpB,KAAK,CAAC,iCAAiC,EAAEgB,GAAG,EAAEC,IAAI,CAAC;EACrD;AACF,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEAd,SAAS,CAACM,SAAS,CAACgB,QAAQ,GAAG,UAAUC,MAAM,EAAE;EAC/C,IAAI,CAACF,IAAI,CAAC,QAAQ,EAAEE,MAAM,CAAC;AAC7B,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEAvB,SAAS,CAACM,SAAS,CAACkB,MAAM,GAAG,UAAUC,IAAI,EAAE;EAC3C,IAAI,CAACH,QAAQ,CAAC3B,MAAM,CAAC+B,YAAY,CAACD,IAAI,CAAC,CAAC;AAC1C,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEAzB,SAAS,CAACM,SAAS,CAACqB,OAAO,GAAG,YAAY;EACxC,IAAI,CAACxB,UAAU,GAAG,QAAQ;EAC1B,IAAI,CAACkB,IAAI,CAAC,OAAO,CAAC;AACpB,CAAC"},"metadata":{},"sourceType":"script"}