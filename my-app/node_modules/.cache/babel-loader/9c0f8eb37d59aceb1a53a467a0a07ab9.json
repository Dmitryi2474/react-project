{"ast":null,"code":"'use strict';\n\n/**\n * Module dependencies.\n */\nvar http = require('http');\nvar read = require('fs').readFileSync;\nvar path = require('path');\nvar exists = require('fs').existsSync;\nvar engine = require('engine.io');\nvar clientVersion = require('socket.io-client/package.json').version;\nvar Client = require('./client');\nvar Emitter = require('events').EventEmitter;\nvar Namespace = require('./namespace');\nvar ParentNamespace = require('./parent-namespace');\nvar Adapter = require('socket.io-adapter');\nvar parser = require('socket.io-parser');\nvar debug = require('debug')('socket.io:server');\nvar url = require('url');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Server;\n\n/**\n * Socket.IO client source.\n */\n\nvar clientSource = undefined;\nvar clientSourceMap = undefined;\n\n/**\n * Server constructor.\n *\n * @param {http.Server|Number|Object} srv http server, port or options\n * @param {Object} [opts]\n * @api public\n */\n\nfunction Server(srv, opts) {\n  if (!(this instanceof Server)) return new Server(srv, opts);\n  if ('object' == typeof srv && srv instanceof Object && !srv.listen) {\n    opts = srv;\n    srv = null;\n  }\n  opts = opts || {};\n  this.nsps = {};\n  this.parentNsps = new Map();\n  this.path(opts.path || '/socket.io');\n  this.serveClient(false !== opts.serveClient);\n  this.parser = opts.parser || parser;\n  this.encoder = new this.parser.Encoder();\n  this.adapter(opts.adapter || Adapter);\n  this.origins(opts.origins || '*:*');\n  this.sockets = this.of('/');\n  if (srv) this.attach(srv, opts);\n}\n\n/**\n * Server request verification function, that checks for allowed origins\n *\n * @param {http.IncomingMessage} req request\n * @param {Function} fn callback to be called with the result: `fn(err, success)`\n */\n\nServer.prototype.checkRequest = function (req, fn) {\n  var origin = req.headers.origin || req.headers.referer;\n\n  // file:// URLs produce a null Origin which can't be authorized via echo-back\n  if ('null' == origin || null == origin) origin = '*';\n  if (!!origin && typeof this._origins == 'function') return this._origins(origin, fn);\n  if (this._origins.indexOf('*:*') !== -1) return fn(null, true);\n  if (origin) {\n    try {\n      var parts = url.parse(origin);\n      var defaultPort = 'https:' == parts.protocol ? 443 : 80;\n      parts.port = parts.port != null ? parts.port : defaultPort;\n      var ok = ~this._origins.indexOf(parts.protocol + '//' + parts.hostname + ':' + parts.port) || ~this._origins.indexOf(parts.hostname + ':' + parts.port) || ~this._origins.indexOf(parts.hostname + ':*') || ~this._origins.indexOf('*:' + parts.port);\n      debug('origin %s is %svalid', origin, !!ok ? '' : 'not ');\n      return fn(null, !!ok);\n    } catch (ex) {}\n  }\n  fn(null, false);\n};\n\n/**\n * Sets/gets whether client code is being served.\n *\n * @param {Boolean} v whether to serve client code\n * @return {Server|Boolean} self when setting or value when getting\n * @api public\n */\n\nServer.prototype.serveClient = function (v) {\n  if (!arguments.length) return this._serveClient;\n  this._serveClient = v;\n  var resolvePath = function (file) {\n    var filepath = path.resolve(__dirname, './../../', file);\n    if (exists(filepath)) {\n      return filepath;\n    }\n    return require.resolve(file);\n  };\n  if (v && !clientSource) {\n    clientSource = read(resolvePath('socket.io-client/dist/socket.io.js'), 'utf-8');\n    try {\n      clientSourceMap = read(resolvePath('socket.io-client/dist/socket.io.js.map'), 'utf-8');\n    } catch (err) {\n      debug('could not load sourcemap file');\n    }\n  }\n  return this;\n};\n\n/**\n * Old settings for backwards compatibility\n */\n\nvar oldSettings = {\n  \"transports\": \"transports\",\n  \"heartbeat timeout\": \"pingTimeout\",\n  \"heartbeat interval\": \"pingInterval\",\n  \"destroy buffer size\": \"maxHttpBufferSize\"\n};\n\n/**\n * Backwards compatibility.\n *\n * @api public\n */\n\nServer.prototype.set = function (key, val) {\n  if ('authorization' == key && val) {\n    this.use(function (socket, next) {\n      val(socket.request, function (err, authorized) {\n        if (err) return next(new Error(err));\n        if (!authorized) return next(new Error('Not authorized'));\n        next();\n      });\n    });\n  } else if ('origins' == key && val) {\n    this.origins(val);\n  } else if ('resource' == key) {\n    this.path(val);\n  } else if (oldSettings[key] && this.eio[oldSettings[key]]) {\n    this.eio[oldSettings[key]] = val;\n  } else {\n    console.error('Option %s is not valid. Please refer to the README.', key);\n  }\n  return this;\n};\n\n/**\n * Executes the middleware for an incoming namespace not already created on the server.\n *\n * @param {String} name name of incoming namespace\n * @param {Object} query the query parameters\n * @param {Function} fn callback\n * @api private\n */\n\nServer.prototype.checkNamespace = function (name, query, fn) {\n  if (this.parentNsps.size === 0) return fn(false);\n  const keysIterator = this.parentNsps.keys();\n  const run = () => {\n    let nextFn = keysIterator.next();\n    if (nextFn.done) {\n      return fn(false);\n    }\n    nextFn.value(name, query, (err, allow) => {\n      if (err || !allow) {\n        run();\n      } else {\n        fn(this.parentNsps.get(nextFn.value).createChild(name));\n      }\n    });\n  };\n  run();\n};\n\n/**\n * Sets the client serving path.\n *\n * @param {String} v pathname\n * @return {Server|String} self when setting or value when getting\n * @api public\n */\n\nServer.prototype.path = function (v) {\n  if (!arguments.length) return this._path;\n  this._path = v.replace(/\\/$/, '');\n  return this;\n};\n\n/**\n * Sets the adapter for rooms.\n *\n * @param {Adapter} v pathname\n * @return {Server|Adapter} self when setting or value when getting\n * @api public\n */\n\nServer.prototype.adapter = function (v) {\n  if (!arguments.length) return this._adapter;\n  this._adapter = v;\n  for (var i in this.nsps) {\n    if (this.nsps.hasOwnProperty(i)) {\n      this.nsps[i].initAdapter();\n    }\n  }\n  return this;\n};\n\n/**\n * Sets the allowed origins for requests.\n *\n * @param {String|String[]} v origins\n * @return {Server|Adapter} self when setting or value when getting\n * @api public\n */\n\nServer.prototype.origins = function (v) {\n  if (!arguments.length) return this._origins;\n  this._origins = v;\n  return this;\n};\n\n/**\n * Attaches socket.io to a server or port.\n *\n * @param {http.Server|Number} server or port\n * @param {Object} options passed to engine.io\n * @return {Server} self\n * @api public\n */\n\nServer.prototype.listen = Server.prototype.attach = function (srv, opts) {\n  if ('function' == typeof srv) {\n    var msg = 'You are trying to attach socket.io to an express ' + 'request handler function. Please pass a http.Server instance.';\n    throw new Error(msg);\n  }\n\n  // handle a port as a string\n  if (Number(srv) == srv) {\n    srv = Number(srv);\n  }\n  if ('number' == typeof srv) {\n    debug('creating http server and binding to %d', srv);\n    var port = srv;\n    srv = http.Server(function (req, res) {\n      res.writeHead(404);\n      res.end();\n    });\n    srv.listen(port);\n  }\n\n  // set engine.io path to `/socket.io`\n  opts = opts || {};\n  opts.path = opts.path || this.path();\n  // set origins verification\n  opts.allowRequest = opts.allowRequest || this.checkRequest.bind(this);\n  if (this.sockets.fns.length > 0) {\n    this.initEngine(srv, opts);\n    return this;\n  }\n  var self = this;\n  var connectPacket = {\n    type: parser.CONNECT,\n    nsp: '/'\n  };\n  this.encoder.encode(connectPacket, function (encodedPacket) {\n    // the CONNECT packet will be merged with Engine.IO handshake,\n    // to reduce the number of round trips\n    opts.initialPacket = encodedPacket;\n    self.initEngine(srv, opts);\n  });\n  return this;\n};\n\n/**\n * Initialize engine\n *\n * @param {Object} options passed to engine.io\n * @api private\n */\n\nServer.prototype.initEngine = function (srv, opts) {\n  // initialize engine\n  debug('creating engine.io instance with opts %j', opts);\n  this.eio = engine.attach(srv, opts);\n\n  // attach static file serving\n  if (this._serveClient) this.attachServe(srv);\n\n  // Export http server\n  this.httpServer = srv;\n\n  // bind to engine events\n  this.bind(this.eio);\n};\n\n/**\n * Attaches the static file serving.\n *\n * @param {Function|http.Server} srv http server\n * @api private\n */\n\nServer.prototype.attachServe = function (srv) {\n  debug('attaching client serving req handler');\n  var url = this._path + '/socket.io.js';\n  var urlMap = this._path + '/socket.io.js.map';\n  var evs = srv.listeners('request').slice(0);\n  var self = this;\n  srv.removeAllListeners('request');\n  srv.on('request', function (req, res) {\n    if (0 === req.url.indexOf(urlMap)) {\n      self.serveMap(req, res);\n    } else if (0 === req.url.indexOf(url)) {\n      self.serve(req, res);\n    } else {\n      for (var i = 0; i < evs.length; i++) {\n        evs[i].call(srv, req, res);\n      }\n    }\n  });\n};\n\n/**\n * Handles a request serving `/socket.io.js`\n *\n * @param {http.Request} req\n * @param {http.Response} res\n * @api private\n */\n\nServer.prototype.serve = function (req, res) {\n  // Per the standard, ETags must be quoted:\n  // https://tools.ietf.org/html/rfc7232#section-2.3\n  var expectedEtag = '\"' + clientVersion + '\"';\n  var etag = req.headers['if-none-match'];\n  if (etag) {\n    if (expectedEtag == etag) {\n      debug('serve client 304');\n      res.writeHead(304);\n      res.end();\n      return;\n    }\n  }\n  debug('serve client source');\n  res.setHeader('Content-Type', 'application/javascript');\n  res.setHeader('ETag', expectedEtag);\n  res.writeHead(200);\n  res.end(clientSource);\n};\n\n/**\n * Handles a request serving `/socket.io.js.map`\n *\n * @param {http.Request} req\n * @param {http.Response} res\n * @api private\n */\n\nServer.prototype.serveMap = function (req, res) {\n  // Per the standard, ETags must be quoted:\n  // https://tools.ietf.org/html/rfc7232#section-2.3\n  var expectedEtag = '\"' + clientVersion + '\"';\n  var etag = req.headers['if-none-match'];\n  if (etag) {\n    if (expectedEtag == etag) {\n      debug('serve client 304');\n      res.writeHead(304);\n      res.end();\n      return;\n    }\n  }\n  debug('serve client sourcemap');\n  res.setHeader('Content-Type', 'application/json');\n  res.setHeader('ETag', expectedEtag);\n  res.writeHead(200);\n  res.end(clientSourceMap);\n};\n\n/**\n * Binds socket.io to an engine.io instance.\n *\n * @param {engine.Server} engine engine.io (or compatible) server\n * @return {Server} self\n * @api public\n */\n\nServer.prototype.bind = function (engine) {\n  this.engine = engine;\n  this.engine.on('connection', this.onconnection.bind(this));\n  return this;\n};\n\n/**\n * Called with each incoming transport connection.\n *\n * @param {engine.Socket} conn\n * @return {Server} self\n * @api public\n */\n\nServer.prototype.onconnection = function (conn) {\n  debug('incoming connection with id %s', conn.id);\n  var client = new Client(this, conn);\n  client.connect('/');\n  return this;\n};\n\n/**\n * Looks up a namespace.\n *\n * @param {String|RegExp|Function} name nsp name\n * @param {Function} [fn] optional, nsp `connection` ev handler\n * @api public\n */\n\nServer.prototype.of = function (name, fn) {\n  if (typeof name === 'function' || name instanceof RegExp) {\n    const parentNsp = new ParentNamespace(this);\n    debug('initializing parent namespace %s', parentNsp.name);\n    if (typeof name === 'function') {\n      this.parentNsps.set(name, parentNsp);\n    } else {\n      this.parentNsps.set((nsp, conn, next) => next(null, name.test(nsp)), parentNsp);\n    }\n    if (fn) parentNsp.on('connect', fn);\n    return parentNsp;\n  }\n  if (String(name)[0] !== '/') name = '/' + name;\n  var nsp = this.nsps[name];\n  if (!nsp) {\n    debug('initializing namespace %s', name);\n    nsp = new Namespace(this, name);\n    this.nsps[name] = nsp;\n  }\n  if (fn) nsp.on('connect', fn);\n  return nsp;\n};\n\n/**\n * Closes server connection\n *\n * @param {Function} [fn] optional, called as `fn([err])` on error OR all conns closed\n * @api public\n */\n\nServer.prototype.close = function (fn) {\n  for (var id in this.nsps['/'].sockets) {\n    if (this.nsps['/'].sockets.hasOwnProperty(id)) {\n      this.nsps['/'].sockets[id].onclose();\n    }\n  }\n  this.engine.close();\n  if (this.httpServer) {\n    this.httpServer.close(fn);\n  } else {\n    fn && fn();\n  }\n};\n\n/**\n * Expose main namespace (/).\n */\n\nvar emitterMethods = Object.keys(Emitter.prototype).filter(function (key) {\n  return typeof Emitter.prototype[key] === 'function';\n});\nemitterMethods.concat(['to', 'in', 'use', 'send', 'write', 'clients', 'compress', 'binary']).forEach(function (fn) {\n  Server.prototype[fn] = function () {\n    return this.sockets[fn].apply(this.sockets, arguments);\n  };\n});\nNamespace.flags.forEach(function (flag) {\n  Object.defineProperty(Server.prototype, flag, {\n    get: function () {\n      this.sockets.flags = this.sockets.flags || {};\n      this.sockets.flags[flag] = true;\n      return this;\n    }\n  });\n});\n\n/**\n * BC with `io.listen`\n */\n\nServer.listen = Server;","map":{"version":3,"names":["http","require","read","readFileSync","path","exists","existsSync","engine","clientVersion","version","Client","Emitter","EventEmitter","Namespace","ParentNamespace","Adapter","parser","debug","url","module","exports","Server","clientSource","undefined","clientSourceMap","srv","opts","Object","listen","nsps","parentNsps","Map","serveClient","encoder","Encoder","adapter","origins","sockets","of","attach","prototype","checkRequest","req","fn","origin","headers","referer","_origins","indexOf","parts","parse","defaultPort","protocol","port","ok","hostname","ex","v","arguments","length","_serveClient","resolvePath","file","filepath","resolve","__dirname","err","oldSettings","set","key","val","use","socket","next","request","authorized","Error","eio","console","error","checkNamespace","name","query","size","keysIterator","keys","run","nextFn","done","value","allow","get","createChild","_path","replace","_adapter","i","hasOwnProperty","initAdapter","msg","Number","res","writeHead","end","allowRequest","bind","fns","initEngine","self","connectPacket","type","CONNECT","nsp","encode","encodedPacket","initialPacket","attachServe","httpServer","urlMap","evs","listeners","slice","removeAllListeners","on","serveMap","serve","call","expectedEtag","etag","setHeader","onconnection","conn","id","client","connect","RegExp","parentNsp","test","String","close","onclose","emitterMethods","filter","concat","forEach","apply","flags","flag","defineProperty"],"sources":["/home/user/Рабочий стол/pizza/project/node_modules/socket.io/lib/index.js"],"sourcesContent":["'use strict';\n\n/**\n * Module dependencies.\n */\n\nvar http = require('http');\nvar read = require('fs').readFileSync;\nvar path = require('path');\nvar exists = require('fs').existsSync;\nvar engine = require('engine.io');\nvar clientVersion = require('socket.io-client/package.json').version;\nvar Client = require('./client');\nvar Emitter = require('events').EventEmitter;\nvar Namespace = require('./namespace');\nvar ParentNamespace = require('./parent-namespace');\nvar Adapter = require('socket.io-adapter');\nvar parser = require('socket.io-parser');\nvar debug = require('debug')('socket.io:server');\nvar url = require('url');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Server;\n\n/**\n * Socket.IO client source.\n */\n\nvar clientSource = undefined;\nvar clientSourceMap = undefined;\n\n/**\n * Server constructor.\n *\n * @param {http.Server|Number|Object} srv http server, port or options\n * @param {Object} [opts]\n * @api public\n */\n\nfunction Server(srv, opts){\n  if (!(this instanceof Server)) return new Server(srv, opts);\n  if ('object' == typeof srv && srv instanceof Object && !srv.listen) {\n    opts = srv;\n    srv = null;\n  }\n  opts = opts || {};\n  this.nsps = {};\n  this.parentNsps = new Map();\n  this.path(opts.path || '/socket.io');\n  this.serveClient(false !== opts.serveClient);\n  this.parser = opts.parser || parser;\n  this.encoder = new this.parser.Encoder();\n  this.adapter(opts.adapter || Adapter);\n  this.origins(opts.origins || '*:*');\n  this.sockets = this.of('/');\n  if (srv) this.attach(srv, opts);\n}\n\n/**\n * Server request verification function, that checks for allowed origins\n *\n * @param {http.IncomingMessage} req request\n * @param {Function} fn callback to be called with the result: `fn(err, success)`\n */\n\nServer.prototype.checkRequest = function(req, fn) {\n  var origin = req.headers.origin || req.headers.referer;\n\n  // file:// URLs produce a null Origin which can't be authorized via echo-back\n  if ('null' == origin || null == origin) origin = '*';\n\n  if (!!origin && typeof(this._origins) == 'function') return this._origins(origin, fn);\n  if (this._origins.indexOf('*:*') !== -1) return fn(null, true);\n  if (origin) {\n    try {\n      var parts = url.parse(origin);\n      var defaultPort = 'https:' == parts.protocol ? 443 : 80;\n      parts.port = parts.port != null\n        ? parts.port\n        : defaultPort;\n      var ok =\n        ~this._origins.indexOf(parts.protocol + '//' + parts.hostname + ':' + parts.port) ||\n        ~this._origins.indexOf(parts.hostname + ':' + parts.port) ||\n        ~this._origins.indexOf(parts.hostname + ':*') ||\n        ~this._origins.indexOf('*:' + parts.port);\n      debug('origin %s is %svalid', origin, !!ok ? '' : 'not ');\n      return fn(null, !!ok);\n    } catch (ex) {\n    }\n  }\n  fn(null, false);\n};\n\n/**\n * Sets/gets whether client code is being served.\n *\n * @param {Boolean} v whether to serve client code\n * @return {Server|Boolean} self when setting or value when getting\n * @api public\n */\n\nServer.prototype.serveClient = function(v){\n  if (!arguments.length) return this._serveClient;\n  this._serveClient = v;\n  var resolvePath = function(file){\n    var filepath = path.resolve(__dirname, './../../', file);\n    if (exists(filepath)) {\n      return filepath;\n    }\n    return require.resolve(file);\n  };\n  if (v && !clientSource) {\n    clientSource = read(resolvePath( 'socket.io-client/dist/socket.io.js'), 'utf-8');\n    try {\n      clientSourceMap = read(resolvePath( 'socket.io-client/dist/socket.io.js.map'), 'utf-8');\n    } catch(err) {\n      debug('could not load sourcemap file');\n    }\n  }\n  return this;\n};\n\n/**\n * Old settings for backwards compatibility\n */\n\nvar oldSettings = {\n  \"transports\": \"transports\",\n  \"heartbeat timeout\": \"pingTimeout\",\n  \"heartbeat interval\": \"pingInterval\",\n  \"destroy buffer size\": \"maxHttpBufferSize\"\n};\n\n/**\n * Backwards compatibility.\n *\n * @api public\n */\n\nServer.prototype.set = function(key, val){\n  if ('authorization' == key && val) {\n    this.use(function(socket, next) {\n      val(socket.request, function(err, authorized) {\n        if (err) return next(new Error(err));\n        if (!authorized) return next(new Error('Not authorized'));\n        next();\n      });\n    });\n  } else if ('origins' == key && val) {\n    this.origins(val);\n  } else if ('resource' == key) {\n    this.path(val);\n  } else if (oldSettings[key] && this.eio[oldSettings[key]]) {\n    this.eio[oldSettings[key]] = val;\n  } else {\n    console.error('Option %s is not valid. Please refer to the README.', key);\n  }\n\n  return this;\n};\n\n/**\n * Executes the middleware for an incoming namespace not already created on the server.\n *\n * @param {String} name name of incoming namespace\n * @param {Object} query the query parameters\n * @param {Function} fn callback\n * @api private\n */\n\nServer.prototype.checkNamespace = function(name, query, fn){\n  if (this.parentNsps.size === 0) return fn(false);\n\n  const keysIterator = this.parentNsps.keys();\n\n  const run = () => {\n    let nextFn = keysIterator.next();\n    if (nextFn.done) {\n      return fn(false);\n    }\n    nextFn.value(name, query, (err, allow) => {\n      if (err || !allow) {\n        run();\n      } else {\n        fn(this.parentNsps.get(nextFn.value).createChild(name));\n      }\n    });\n  };\n\n  run();\n};\n\n/**\n * Sets the client serving path.\n *\n * @param {String} v pathname\n * @return {Server|String} self when setting or value when getting\n * @api public\n */\n\nServer.prototype.path = function(v){\n  if (!arguments.length) return this._path;\n  this._path = v.replace(/\\/$/, '');\n  return this;\n};\n\n/**\n * Sets the adapter for rooms.\n *\n * @param {Adapter} v pathname\n * @return {Server|Adapter} self when setting or value when getting\n * @api public\n */\n\nServer.prototype.adapter = function(v){\n  if (!arguments.length) return this._adapter;\n  this._adapter = v;\n  for (var i in this.nsps) {\n    if (this.nsps.hasOwnProperty(i)) {\n      this.nsps[i].initAdapter();\n    }\n  }\n  return this;\n};\n\n/**\n * Sets the allowed origins for requests.\n *\n * @param {String|String[]} v origins\n * @return {Server|Adapter} self when setting or value when getting\n * @api public\n */\n\nServer.prototype.origins = function(v){\n  if (!arguments.length) return this._origins;\n\n  this._origins = v;\n  return this;\n};\n\n/**\n * Attaches socket.io to a server or port.\n *\n * @param {http.Server|Number} server or port\n * @param {Object} options passed to engine.io\n * @return {Server} self\n * @api public\n */\n\nServer.prototype.listen =\nServer.prototype.attach = function(srv, opts){\n  if ('function' == typeof srv) {\n    var msg = 'You are trying to attach socket.io to an express ' +\n    'request handler function. Please pass a http.Server instance.';\n    throw new Error(msg);\n  }\n\n  // handle a port as a string\n  if (Number(srv) == srv) {\n    srv = Number(srv);\n  }\n\n  if ('number' == typeof srv) {\n    debug('creating http server and binding to %d', srv);\n    var port = srv;\n    srv = http.Server(function(req, res){\n      res.writeHead(404);\n      res.end();\n    });\n    srv.listen(port);\n\n  }\n\n  // set engine.io path to `/socket.io`\n  opts = opts || {};\n  opts.path = opts.path || this.path();\n  // set origins verification\n  opts.allowRequest = opts.allowRequest || this.checkRequest.bind(this);\n\n  if (this.sockets.fns.length > 0) {\n    this.initEngine(srv, opts);\n    return this;\n  }\n\n  var self = this;\n  var connectPacket = { type: parser.CONNECT, nsp: '/' };\n  this.encoder.encode(connectPacket, function (encodedPacket){\n    // the CONNECT packet will be merged with Engine.IO handshake,\n    // to reduce the number of round trips\n    opts.initialPacket = encodedPacket;\n\n    self.initEngine(srv, opts);\n  });\n  return this;\n};\n\n/**\n * Initialize engine\n *\n * @param {Object} options passed to engine.io\n * @api private\n */\n\nServer.prototype.initEngine = function(srv, opts){\n  // initialize engine\n  debug('creating engine.io instance with opts %j', opts);\n  this.eio = engine.attach(srv, opts);\n\n  // attach static file serving\n  if (this._serveClient) this.attachServe(srv);\n\n  // Export http server\n  this.httpServer = srv;\n\n  // bind to engine events\n  this.bind(this.eio);\n};\n\n/**\n * Attaches the static file serving.\n *\n * @param {Function|http.Server} srv http server\n * @api private\n */\n\nServer.prototype.attachServe = function(srv){\n  debug('attaching client serving req handler');\n  var url = this._path + '/socket.io.js';\n  var urlMap = this._path + '/socket.io.js.map';\n  var evs = srv.listeners('request').slice(0);\n  var self = this;\n  srv.removeAllListeners('request');\n  srv.on('request', function(req, res) {\n    if (0 === req.url.indexOf(urlMap)) {\n      self.serveMap(req, res);\n    } else if (0 === req.url.indexOf(url)) {\n      self.serve(req, res);\n    } else {\n      for (var i = 0; i < evs.length; i++) {\n        evs[i].call(srv, req, res);\n      }\n    }\n  });\n};\n\n/**\n * Handles a request serving `/socket.io.js`\n *\n * @param {http.Request} req\n * @param {http.Response} res\n * @api private\n */\n\nServer.prototype.serve = function(req, res){\n  // Per the standard, ETags must be quoted:\n  // https://tools.ietf.org/html/rfc7232#section-2.3\n  var expectedEtag = '\"' + clientVersion + '\"';\n\n  var etag = req.headers['if-none-match'];\n  if (etag) {\n    if (expectedEtag == etag) {\n      debug('serve client 304');\n      res.writeHead(304);\n      res.end();\n      return;\n    }\n  }\n\n  debug('serve client source');\n  res.setHeader('Content-Type', 'application/javascript');\n  res.setHeader('ETag', expectedEtag);\n  res.writeHead(200);\n  res.end(clientSource);\n};\n\n/**\n * Handles a request serving `/socket.io.js.map`\n *\n * @param {http.Request} req\n * @param {http.Response} res\n * @api private\n */\n\nServer.prototype.serveMap = function(req, res){\n  // Per the standard, ETags must be quoted:\n  // https://tools.ietf.org/html/rfc7232#section-2.3\n  var expectedEtag = '\"' + clientVersion + '\"';\n\n  var etag = req.headers['if-none-match'];\n  if (etag) {\n    if (expectedEtag == etag) {\n      debug('serve client 304');\n      res.writeHead(304);\n      res.end();\n      return;\n    }\n  }\n\n  debug('serve client sourcemap');\n  res.setHeader('Content-Type', 'application/json');\n  res.setHeader('ETag', expectedEtag);\n  res.writeHead(200);\n  res.end(clientSourceMap);\n};\n\n/**\n * Binds socket.io to an engine.io instance.\n *\n * @param {engine.Server} engine engine.io (or compatible) server\n * @return {Server} self\n * @api public\n */\n\nServer.prototype.bind = function(engine){\n  this.engine = engine;\n  this.engine.on('connection', this.onconnection.bind(this));\n  return this;\n};\n\n/**\n * Called with each incoming transport connection.\n *\n * @param {engine.Socket} conn\n * @return {Server} self\n * @api public\n */\n\nServer.prototype.onconnection = function(conn){\n  debug('incoming connection with id %s', conn.id);\n  var client = new Client(this, conn);\n  client.connect('/');\n  return this;\n};\n\n/**\n * Looks up a namespace.\n *\n * @param {String|RegExp|Function} name nsp name\n * @param {Function} [fn] optional, nsp `connection` ev handler\n * @api public\n */\n\nServer.prototype.of = function(name, fn){\n  if (typeof name === 'function' || name instanceof RegExp) {\n    const parentNsp = new ParentNamespace(this);\n    debug('initializing parent namespace %s', parentNsp.name);\n    if (typeof name === 'function') {\n      this.parentNsps.set(name, parentNsp);\n    } else {\n      this.parentNsps.set((nsp, conn, next) => next(null, name.test(nsp)), parentNsp);\n    }\n    if (fn) parentNsp.on('connect', fn);\n    return parentNsp;\n  }\n\n  if (String(name)[0] !== '/') name = '/' + name;\n\n  var nsp = this.nsps[name];\n  if (!nsp) {\n    debug('initializing namespace %s', name);\n    nsp = new Namespace(this, name);\n    this.nsps[name] = nsp;\n  }\n  if (fn) nsp.on('connect', fn);\n  return nsp;\n};\n\n/**\n * Closes server connection\n *\n * @param {Function} [fn] optional, called as `fn([err])` on error OR all conns closed\n * @api public\n */\n\nServer.prototype.close = function(fn){\n  for (var id in this.nsps['/'].sockets) {\n    if (this.nsps['/'].sockets.hasOwnProperty(id)) {\n      this.nsps['/'].sockets[id].onclose();\n    }\n  }\n\n  this.engine.close();\n\n  if (this.httpServer) {\n    this.httpServer.close(fn);\n  } else {\n    fn && fn();\n  }\n};\n\n/**\n * Expose main namespace (/).\n */\n\nvar emitterMethods = Object.keys(Emitter.prototype).filter(function(key){\n  return typeof Emitter.prototype[key] === 'function';\n});\n\nemitterMethods.concat(['to', 'in', 'use', 'send', 'write', 'clients', 'compress', 'binary']).forEach(function(fn){\n  Server.prototype[fn] = function(){\n    return this.sockets[fn].apply(this.sockets, arguments);\n  };\n});\n\nNamespace.flags.forEach(function(flag){\n  Object.defineProperty(Server.prototype, flag, {\n    get: function() {\n      this.sockets.flags = this.sockets.flags || {};\n      this.sockets.flags[flag] = true;\n      return this;\n    }\n  });\n});\n\n/**\n * BC with `io.listen`\n */\n\nServer.listen = Server;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}