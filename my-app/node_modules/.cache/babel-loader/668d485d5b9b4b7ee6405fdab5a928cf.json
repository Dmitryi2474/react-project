{"ast":null,"code":"var fs = require(\"fs\");\nconst CLIENT_FILES_OPT = \"clientFiles\";\n\n/**\n * Enable a element on clients\n * @param clients\n * @param ui\n * @param bs\n * @returns {Function}\n */\n\nvar types = {\n  \"css\": \"text/css\",\n  \"js\": \"application/javascript\"\n};\nfunction enableElement(clients, ui, bs) {\n  return function (file) {\n    var uiItem = ui.getOptionIn([CLIENT_FILES_OPT, file.name]);\n    var item = uiItem.toJS();\n    var enableFn = uiItem.getIn([\"callbacks\", \"enable\"]);\n    if (item.active) {\n      return;\n    }\n    ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"active\"], true, {\n      silent: true\n    });\n    if (enableFn) {\n      enableFn.call(ui, item);\n    }\n    if (item.file && !item.served) {\n      ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"served\"], true, {\n        silent: true\n      });\n      bs.serveFile(item.src, {\n        type: types[item.type],\n        content: fs.readFileSync(item.file)\n      });\n    }\n    addElement(clients, ui.getOptionIn([CLIENT_FILES_OPT, item.name]).toJS());\n  };\n}\n\n/**\n * @param clients\n * @param ui\n * @returns {Function}\n */\nfunction disableElement(clients, ui) {\n  return function (file) {\n    var uiItem = ui.getOptionIn([CLIENT_FILES_OPT, file.name]);\n    var item = uiItem.toJS();\n    var disableFn = uiItem.getIn([\"callbacks\", \"disable\"]);\n    if (disableFn) {\n      disableFn.call(ui, item);\n    }\n    ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"active\"], false, {\n      silent: true\n    });\n    removeElement(clients, item.id);\n  };\n}\n\n/**\n * @param clients\n * @param item\n */\nfunction addElement(clients, item) {\n  clients.emit(\"ui:element:add\", item);\n}\n\n/**\n * @param clients\n * @param id\n */\nfunction removeElement(clients, id) {\n  clients.emit(\"ui:element:remove\", {\n    id: id\n  });\n}\nmodule.exports.addElement = addElement;\nmodule.exports.removeElement = removeElement;\nmodule.exports.enable = enableElement;\nmodule.exports.disable = disableElement;","map":{"version":3,"names":["fs","require","CLIENT_FILES_OPT","types","enableElement","clients","ui","bs","file","uiItem","getOptionIn","name","item","toJS","enableFn","getIn","active","setOptionIn","silent","call","served","serveFile","src","type","content","readFileSync","addElement","disableElement","disableFn","removeElement","id","emit","module","exports","enable","disable"],"sources":["/home/user/Рабочий стол/pizza/project/node_modules/browser-sync-ui/lib/client-elements.js"],"sourcesContent":["var fs = require(\"fs\");\n\nconst CLIENT_FILES_OPT = \"clientFiles\";\n\n/**\n * Enable a element on clients\n * @param clients\n * @param ui\n * @param bs\n * @returns {Function}\n */\n\nvar types = {\n    \"css\": \"text/css\",\n    \"js\":  \"application/javascript\"\n};\n\nfunction enableElement (clients, ui, bs) {\n\n    return function (file) {\n\n        var uiItem   = ui.getOptionIn([CLIENT_FILES_OPT, file.name]);\n        var item     = uiItem.toJS();\n        var enableFn = uiItem.getIn([\"callbacks\", \"enable\"]);\n\n        if (item.active) {\n            return;\n        }\n\n        ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"active\"], true, {silent: true});\n\n        if (enableFn) {\n            enableFn.call(ui, item);\n        }\n\n        if (item.file && !item.served) {\n\n            ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"served\"], true, {silent: true});\n\n            bs.serveFile(item.src, {\n                type:    types[item.type],\n                content: fs.readFileSync(item.file)\n            });\n        }\n\n        addElement(clients, ui.getOptionIn([CLIENT_FILES_OPT, item.name]).toJS());\n    };\n}\n\n/**\n * @param clients\n * @param ui\n * @returns {Function}\n */\nfunction disableElement (clients, ui) {\n\n    return function (file) {\n        var uiItem    = ui.getOptionIn([CLIENT_FILES_OPT, file.name]);\n        var item      = uiItem.toJS();\n        var disableFn = uiItem.getIn([\"callbacks\", \"disable\"]);\n\n        if (disableFn) {\n            disableFn.call(ui, item);\n        }\n\n        ui.setOptionIn([CLIENT_FILES_OPT, item.name, \"active\"], false, {silent: true});\n\n        removeElement(clients, item.id);\n    };\n}\n\n/**\n * @param clients\n * @param item\n */\nfunction addElement (clients, item) {\n\n    clients.emit(\"ui:element:add\", item);\n}\n\n/**\n * @param clients\n * @param id\n */\nfunction removeElement(clients, id) {\n\n    clients.emit(\"ui:element:remove\", {id: id});\n}\n\nmodule.exports.addElement    = addElement;\nmodule.exports.removeElement = removeElement;\nmodule.exports.enable        = enableElement;\nmodule.exports.disable       = disableElement;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}