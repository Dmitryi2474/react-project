{"ast":null,"code":"/**\n * Module dependencies.\n */\n\nvar Emitter = require('events').EventEmitter;\nvar parser = require('socket.io-parser');\nvar hasBin = require('has-binary2');\nvar url = require('url');\nvar debug = require('debug')('socket.io:socket');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = Socket;\n\n/**\n * Blacklisted events.\n *\n * @api public\n */\n\nexports.events = ['error', 'connect', 'disconnect', 'disconnecting', 'newListener', 'removeListener'];\n\n/**\n * Flags.\n *\n * @api private\n */\n\nvar flags = ['json', 'volatile', 'broadcast', 'local'];\n\n/**\n * `EventEmitter#emit` reference.\n */\n\nvar emit = Emitter.prototype.emit;\n\n/**\n * Interface to a `Client` for a given `Namespace`.\n *\n * @param {Namespace} nsp\n * @param {Client} client\n * @api public\n */\n\nfunction Socket(nsp, client, query) {\n  this.nsp = nsp;\n  this.server = nsp.server;\n  this.adapter = this.nsp.adapter;\n  this.id = nsp.name !== '/' ? nsp.name + '#' + client.id : client.id;\n  this.client = client;\n  this.conn = client.conn;\n  this.rooms = {};\n  this.acks = {};\n  this.connected = true;\n  this.disconnected = false;\n  this.handshake = this.buildHandshake(query);\n  this.fns = [];\n  this.flags = {};\n  this._rooms = [];\n}\n\n/**\n * Inherits from `EventEmitter`.\n */\n\nSocket.prototype.__proto__ = Emitter.prototype;\n\n/**\n * Apply flags from `Socket`.\n */\n\nflags.forEach(function (flag) {\n  Object.defineProperty(Socket.prototype, flag, {\n    get: function () {\n      this.flags[flag] = true;\n      return this;\n    }\n  });\n});\n\n/**\n * `request` engine.io shortcut.\n *\n * @api public\n */\n\nObject.defineProperty(Socket.prototype, 'request', {\n  get: function () {\n    return this.conn.request;\n  }\n});\n\n/**\n * Builds the `handshake` BC object\n *\n * @api private\n */\n\nSocket.prototype.buildHandshake = function (query) {\n  var self = this;\n  function buildQuery() {\n    var requestQuery = url.parse(self.request.url, true).query;\n    //if socket-specific query exist, replace query strings in requestQuery\n    return Object.assign({}, query, requestQuery);\n  }\n  return {\n    headers: this.request.headers,\n    time: new Date() + '',\n    address: this.conn.remoteAddress,\n    xdomain: !!this.request.headers.origin,\n    secure: !!this.request.connection.encrypted,\n    issued: +new Date(),\n    url: this.request.url,\n    query: buildQuery()\n  };\n};\n\n/**\n * Emits to this client.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.emit = function (ev) {\n  if (~exports.events.indexOf(ev)) {\n    emit.apply(this, arguments);\n    return this;\n  }\n  var args = Array.prototype.slice.call(arguments);\n  var packet = {\n    type: (this.flags.binary !== undefined ? this.flags.binary : hasBin(args)) ? parser.BINARY_EVENT : parser.EVENT,\n    data: args\n  };\n\n  // access last argument to see if it's an ACK callback\n  if (typeof args[args.length - 1] === 'function') {\n    if (this._rooms.length || this.flags.broadcast) {\n      throw new Error('Callbacks are not supported when broadcasting');\n    }\n    debug('emitting packet with ack id %d', this.nsp.ids);\n    this.acks[this.nsp.ids] = args.pop();\n    packet.id = this.nsp.ids++;\n  }\n  var rooms = this._rooms.slice(0);\n  var flags = Object.assign({}, this.flags);\n\n  // reset flags\n  this._rooms = [];\n  this.flags = {};\n  if (rooms.length || flags.broadcast) {\n    this.adapter.broadcast(packet, {\n      except: [this.id],\n      rooms: rooms,\n      flags: flags\n    });\n  } else {\n    // dispatch packet\n    this.packet(packet, flags);\n  }\n  return this;\n};\n\n/**\n * Targets a room when broadcasting.\n *\n * @param {String} name\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.to = Socket.prototype.in = function (name) {\n  if (!~this._rooms.indexOf(name)) this._rooms.push(name);\n  return this;\n};\n\n/**\n * Sends a `message` event.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.send = Socket.prototype.write = function () {\n  var args = Array.prototype.slice.call(arguments);\n  args.unshift('message');\n  this.emit.apply(this, args);\n  return this;\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet object\n * @param {Object} opts options\n * @api private\n */\n\nSocket.prototype.packet = function (packet, opts) {\n  packet.nsp = this.nsp.name;\n  opts = opts || {};\n  opts.compress = false !== opts.compress;\n  this.client.packet(packet, opts);\n};\n\n/**\n * Joins a room.\n *\n * @param {String|Array} room or array of rooms\n * @param {Function} fn optional, callback\n * @return {Socket} self\n * @api private\n */\n\nSocket.prototype.join = function (rooms, fn) {\n  debug('joining room %s', rooms);\n  var self = this;\n  if (!Array.isArray(rooms)) {\n    rooms = [rooms];\n  }\n  rooms = rooms.filter(function (room) {\n    return !self.rooms.hasOwnProperty(room);\n  });\n  if (!rooms.length) {\n    fn && fn(null);\n    return this;\n  }\n  this.adapter.addAll(this.id, rooms, function (err) {\n    if (err) return fn && fn(err);\n    debug('joined room %s', rooms);\n    rooms.forEach(function (room) {\n      self.rooms[room] = room;\n    });\n    fn && fn(null);\n  });\n  return this;\n};\n\n/**\n * Leaves a room.\n *\n * @param {String} room\n * @param {Function} fn optional, callback\n * @return {Socket} self\n * @api private\n */\n\nSocket.prototype.leave = function (room, fn) {\n  debug('leave room %s', room);\n  var self = this;\n  this.adapter.del(this.id, room, function (err) {\n    if (err) return fn && fn(err);\n    debug('left room %s', room);\n    delete self.rooms[room];\n    fn && fn(null);\n  });\n  return this;\n};\n\n/**\n * Leave all rooms.\n *\n * @api private\n */\n\nSocket.prototype.leaveAll = function () {\n  this.adapter.delAll(this.id);\n  this.rooms = {};\n};\n\n/**\n * Called by `Namespace` upon successful\n * middleware execution (ie: authorization).\n * Socket is added to namespace array before\n * call to join, so adapters can access it.\n *\n * @api private\n */\n\nSocket.prototype.onconnect = function () {\n  debug('socket connected - writing packet');\n  this.nsp.connected[this.id] = this;\n  this.join(this.id);\n  var skip = this.nsp.name === '/' && this.nsp.fns.length === 0;\n  if (skip) {\n    debug('packet already sent in initial handshake');\n  } else {\n    this.packet({\n      type: parser.CONNECT\n    });\n  }\n};\n\n/**\n * Called with each packet. Called by `Client`.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onpacket = function (packet) {\n  debug('got packet %j', packet);\n  switch (packet.type) {\n    case parser.EVENT:\n      this.onevent(packet);\n      break;\n    case parser.BINARY_EVENT:\n      this.onevent(packet);\n      break;\n    case parser.ACK:\n      this.onack(packet);\n      break;\n    case parser.BINARY_ACK:\n      this.onack(packet);\n      break;\n    case parser.DISCONNECT:\n      this.ondisconnect();\n      break;\n    case parser.ERROR:\n      this.onerror(new Error(packet.data));\n  }\n};\n\n/**\n * Called upon event packet.\n *\n * @param {Object} packet object\n * @api private\n */\n\nSocket.prototype.onevent = function (packet) {\n  var args = packet.data || [];\n  debug('emitting event %j', args);\n  if (null != packet.id) {\n    debug('attaching ack callback to event');\n    args.push(this.ack(packet.id));\n  }\n  this.dispatch(args);\n};\n\n/**\n * Produces an ack callback to emit with an event.\n *\n * @param {Number} id packet id\n * @api private\n */\n\nSocket.prototype.ack = function (id) {\n  var self = this;\n  var sent = false;\n  return function () {\n    // prevent double callbacks\n    if (sent) return;\n    var args = Array.prototype.slice.call(arguments);\n    debug('sending ack %j', args);\n    self.packet({\n      id: id,\n      type: hasBin(args) ? parser.BINARY_ACK : parser.ACK,\n      data: args\n    });\n    sent = true;\n  };\n};\n\n/**\n * Called upon ack packet.\n *\n * @api private\n */\n\nSocket.prototype.onack = function (packet) {\n  var ack = this.acks[packet.id];\n  if ('function' == typeof ack) {\n    debug('calling ack %s with %j', packet.id, packet.data);\n    ack.apply(this, packet.data);\n    delete this.acks[packet.id];\n  } else {\n    debug('bad ack %s', packet.id);\n  }\n};\n\n/**\n * Called upon client disconnect packet.\n *\n * @api private\n */\n\nSocket.prototype.ondisconnect = function () {\n  debug('got disconnect packet');\n  this.onclose('client namespace disconnect');\n};\n\n/**\n * Handles a client error.\n *\n * @api private\n */\n\nSocket.prototype.onerror = function (err) {\n  if (this.listeners('error').length) {\n    this.emit('error', err);\n  } else {\n    console.error('Missing error handler on `socket`.');\n    console.error(err.stack);\n  }\n};\n\n/**\n * Called upon closing. Called by `Client`.\n *\n * @param {String} reason\n * @throw {Error} optional error object\n * @api private\n */\n\nSocket.prototype.onclose = function (reason) {\n  if (!this.connected) return this;\n  debug('closing socket - reason %s', reason);\n  this.emit('disconnecting', reason);\n  this.leaveAll();\n  this.nsp.remove(this);\n  this.client.remove(this);\n  this.connected = false;\n  this.disconnected = true;\n  delete this.nsp.connected[this.id];\n  this.emit('disconnect', reason);\n};\n\n/**\n * Produces an `error` packet.\n *\n * @param {Object} err error object\n * @api private\n */\n\nSocket.prototype.error = function (err) {\n  this.packet({\n    type: parser.ERROR,\n    data: err\n  });\n};\n\n/**\n * Disconnects this client.\n *\n * @param {Boolean} close if `true`, closes the underlying connection\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.disconnect = function (close) {\n  if (!this.connected) return this;\n  if (close) {\n    this.client.disconnect();\n  } else {\n    this.packet({\n      type: parser.DISCONNECT\n    });\n    this.onclose('server namespace disconnect');\n  }\n  return this;\n};\n\n/**\n * Sets the compress flag.\n *\n * @param {Boolean} compress if `true`, compresses the sending data\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.compress = function (compress) {\n  this.flags.compress = compress;\n  return this;\n};\n\n/**\n * Sets the binary flag\n *\n * @param {Boolean} Encode as if it has binary data if `true`, Encode as if it doesnt have binary data if `false`\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.binary = function (binary) {\n  this.flags.binary = binary;\n  return this;\n};\n\n/**\n * Dispatch incoming event to socket listeners.\n *\n * @param {Array} event that will get emitted\n * @api private\n */\n\nSocket.prototype.dispatch = function (event) {\n  debug('dispatching an event %j', event);\n  var self = this;\n  function dispatchSocket(err) {\n    process.nextTick(function () {\n      if (err) {\n        return self.error(err.data || err.message);\n      }\n      emit.apply(self, event);\n    });\n  }\n  this.run(event, dispatchSocket);\n};\n\n/**\n * Sets up socket middleware.\n *\n * @param {Function} middleware function (event, next)\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.use = function (fn) {\n  this.fns.push(fn);\n  return this;\n};\n\n/**\n * Executes the middleware for an incoming event.\n *\n * @param {Array} event that will get emitted\n * @param {Function} last fn call in the middleware\n * @api private\n */\nSocket.prototype.run = function (event, fn) {\n  var fns = this.fns.slice(0);\n  if (!fns.length) return fn(null);\n  function run(i) {\n    fns[i](event, function (err) {\n      // upon error, short-circuit\n      if (err) return fn(err);\n\n      // if no middleware left, summon callback\n      if (!fns[i + 1]) return fn(null);\n\n      // go on to next\n      run(i + 1);\n    });\n  }\n  run(0);\n};","map":{"version":3,"names":["Emitter","require","EventEmitter","parser","hasBin","url","debug","module","exports","Socket","events","flags","emit","prototype","nsp","client","query","server","adapter","id","name","conn","rooms","acks","connected","disconnected","handshake","buildHandshake","fns","_rooms","__proto__","forEach","flag","Object","defineProperty","get","request","self","buildQuery","requestQuery","parse","assign","headers","time","Date","address","remoteAddress","xdomain","origin","secure","connection","encrypted","issued","ev","indexOf","apply","arguments","args","Array","slice","call","packet","type","binary","undefined","BINARY_EVENT","EVENT","data","length","broadcast","Error","ids","pop","except","to","in","push","send","write","unshift","opts","compress","join","fn","isArray","filter","room","hasOwnProperty","addAll","err","leave","del","leaveAll","delAll","onconnect","skip","CONNECT","onpacket","onevent","ACK","onack","BINARY_ACK","DISCONNECT","ondisconnect","ERROR","onerror","ack","dispatch","sent","onclose","listeners","console","error","stack","reason","remove","disconnect","close","event","dispatchSocket","process","nextTick","message","run","use","i"],"sources":["/home/user/Рабочий стол/pizza/project/node_modules/socket.io/lib/socket.js"],"sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar Emitter = require('events').EventEmitter;\nvar parser = require('socket.io-parser');\nvar hasBin = require('has-binary2');\nvar url = require('url');\nvar debug = require('debug')('socket.io:socket');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = Socket;\n\n/**\n * Blacklisted events.\n *\n * @api public\n */\n\nexports.events = [\n  'error',\n  'connect',\n  'disconnect',\n  'disconnecting',\n  'newListener',\n  'removeListener'\n];\n\n/**\n * Flags.\n *\n * @api private\n */\n\nvar flags = [\n  'json',\n  'volatile',\n  'broadcast',\n  'local'\n];\n\n/**\n * `EventEmitter#emit` reference.\n */\n\nvar emit = Emitter.prototype.emit;\n\n/**\n * Interface to a `Client` for a given `Namespace`.\n *\n * @param {Namespace} nsp\n * @param {Client} client\n * @api public\n */\n\nfunction Socket(nsp, client, query){\n  this.nsp = nsp;\n  this.server = nsp.server;\n  this.adapter = this.nsp.adapter;\n  this.id = nsp.name !== '/' ? nsp.name + '#' + client.id : client.id;\n  this.client = client;\n  this.conn = client.conn;\n  this.rooms = {};\n  this.acks = {};\n  this.connected = true;\n  this.disconnected = false;\n  this.handshake = this.buildHandshake(query);\n  this.fns = [];\n  this.flags = {};\n  this._rooms = [];\n}\n\n/**\n * Inherits from `EventEmitter`.\n */\n\nSocket.prototype.__proto__ = Emitter.prototype;\n\n/**\n * Apply flags from `Socket`.\n */\n\nflags.forEach(function(flag){\n  Object.defineProperty(Socket.prototype, flag, {\n    get: function() {\n      this.flags[flag] = true;\n      return this;\n    }\n  });\n});\n\n/**\n * `request` engine.io shortcut.\n *\n * @api public\n */\n\nObject.defineProperty(Socket.prototype, 'request', {\n  get: function() {\n    return this.conn.request;\n  }\n});\n\n/**\n * Builds the `handshake` BC object\n *\n * @api private\n */\n\nSocket.prototype.buildHandshake = function(query){\n  var self = this;\n  function buildQuery(){\n    var requestQuery = url.parse(self.request.url, true).query;\n    //if socket-specific query exist, replace query strings in requestQuery\n    return Object.assign({}, query, requestQuery);\n  }\n  return {\n    headers: this.request.headers,\n    time: (new Date) + '',\n    address: this.conn.remoteAddress,\n    xdomain: !!this.request.headers.origin,\n    secure: !!this.request.connection.encrypted,\n    issued: +(new Date),\n    url: this.request.url,\n    query: buildQuery()\n  };\n};\n\n/**\n * Emits to this client.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.emit = function(ev){\n  if (~exports.events.indexOf(ev)) {\n    emit.apply(this, arguments);\n    return this;\n  }\n\n  var args = Array.prototype.slice.call(arguments);\n  var packet = {\n    type: (this.flags.binary !== undefined ? this.flags.binary : hasBin(args)) ? parser.BINARY_EVENT : parser.EVENT,\n    data: args\n  };\n\n  // access last argument to see if it's an ACK callback\n  if (typeof args[args.length - 1] === 'function') {\n    if (this._rooms.length || this.flags.broadcast) {\n      throw new Error('Callbacks are not supported when broadcasting');\n    }\n\n    debug('emitting packet with ack id %d', this.nsp.ids);\n    this.acks[this.nsp.ids] = args.pop();\n    packet.id = this.nsp.ids++;\n  }\n\n  var rooms = this._rooms.slice(0);\n  var flags = Object.assign({}, this.flags);\n\n  // reset flags\n  this._rooms = [];\n  this.flags = {};\n\n  if (rooms.length || flags.broadcast) {\n    this.adapter.broadcast(packet, {\n      except: [this.id],\n      rooms: rooms,\n      flags: flags\n    });\n  } else {\n    // dispatch packet\n    this.packet(packet, flags);\n  }\n  return this;\n};\n\n/**\n * Targets a room when broadcasting.\n *\n * @param {String} name\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.to =\nSocket.prototype.in = function(name){\n  if (!~this._rooms.indexOf(name)) this._rooms.push(name);\n  return this;\n};\n\n/**\n * Sends a `message` event.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.send =\nSocket.prototype.write = function(){\n  var args = Array.prototype.slice.call(arguments);\n  args.unshift('message');\n  this.emit.apply(this, args);\n  return this;\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet object\n * @param {Object} opts options\n * @api private\n */\n\nSocket.prototype.packet = function(packet, opts){\n  packet.nsp = this.nsp.name;\n  opts = opts || {};\n  opts.compress = false !== opts.compress;\n  this.client.packet(packet, opts);\n};\n\n/**\n * Joins a room.\n *\n * @param {String|Array} room or array of rooms\n * @param {Function} fn optional, callback\n * @return {Socket} self\n * @api private\n */\n\nSocket.prototype.join = function(rooms, fn){\n  debug('joining room %s', rooms);\n  var self = this;\n  if (!Array.isArray(rooms)) {\n    rooms = [rooms];\n  }\n  rooms = rooms.filter(function (room) {\n    return !self.rooms.hasOwnProperty(room);\n  });\n  if (!rooms.length) {\n    fn && fn(null);\n    return this;\n  }\n  this.adapter.addAll(this.id, rooms, function(err){\n    if (err) return fn && fn(err);\n    debug('joined room %s', rooms);\n    rooms.forEach(function (room) {\n      self.rooms[room] = room;\n    });\n    fn && fn(null);\n  });\n  return this;\n};\n\n/**\n * Leaves a room.\n *\n * @param {String} room\n * @param {Function} fn optional, callback\n * @return {Socket} self\n * @api private\n */\n\nSocket.prototype.leave = function(room, fn){\n  debug('leave room %s', room);\n  var self = this;\n  this.adapter.del(this.id, room, function(err){\n    if (err) return fn && fn(err);\n    debug('left room %s', room);\n    delete self.rooms[room];\n    fn && fn(null);\n  });\n  return this;\n};\n\n/**\n * Leave all rooms.\n *\n * @api private\n */\n\nSocket.prototype.leaveAll = function(){\n  this.adapter.delAll(this.id);\n  this.rooms = {};\n};\n\n/**\n * Called by `Namespace` upon successful\n * middleware execution (ie: authorization).\n * Socket is added to namespace array before\n * call to join, so adapters can access it.\n *\n * @api private\n */\n\nSocket.prototype.onconnect = function(){\n  debug('socket connected - writing packet');\n  this.nsp.connected[this.id] = this;\n  this.join(this.id);\n  var skip = this.nsp.name === '/' && this.nsp.fns.length === 0;\n  if (skip) {\n    debug('packet already sent in initial handshake');\n  } else {\n    this.packet({ type: parser.CONNECT });\n  }\n};\n\n/**\n * Called with each packet. Called by `Client`.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onpacket = function(packet){\n  debug('got packet %j', packet);\n  switch (packet.type) {\n    case parser.EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.BINARY_EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.ACK:\n      this.onack(packet);\n      break;\n\n    case parser.BINARY_ACK:\n      this.onack(packet);\n      break;\n\n    case parser.DISCONNECT:\n      this.ondisconnect();\n      break;\n\n    case parser.ERROR:\n      this.onerror(new Error(packet.data));\n  }\n};\n\n/**\n * Called upon event packet.\n *\n * @param {Object} packet object\n * @api private\n */\n\nSocket.prototype.onevent = function(packet){\n  var args = packet.data || [];\n  debug('emitting event %j', args);\n\n  if (null != packet.id) {\n    debug('attaching ack callback to event');\n    args.push(this.ack(packet.id));\n  }\n\n  this.dispatch(args);\n};\n\n/**\n * Produces an ack callback to emit with an event.\n *\n * @param {Number} id packet id\n * @api private\n */\n\nSocket.prototype.ack = function(id){\n  var self = this;\n  var sent = false;\n  return function(){\n    // prevent double callbacks\n    if (sent) return;\n    var args = Array.prototype.slice.call(arguments);\n    debug('sending ack %j', args);\n\n    self.packet({\n      id: id,\n      type: hasBin(args) ? parser.BINARY_ACK : parser.ACK,\n      data: args\n    });\n\n    sent = true;\n  };\n};\n\n/**\n * Called upon ack packet.\n *\n * @api private\n */\n\nSocket.prototype.onack = function(packet){\n  var ack = this.acks[packet.id];\n  if ('function' == typeof ack) {\n    debug('calling ack %s with %j', packet.id, packet.data);\n    ack.apply(this, packet.data);\n    delete this.acks[packet.id];\n  } else {\n    debug('bad ack %s', packet.id);\n  }\n};\n\n/**\n * Called upon client disconnect packet.\n *\n * @api private\n */\n\nSocket.prototype.ondisconnect = function(){\n  debug('got disconnect packet');\n  this.onclose('client namespace disconnect');\n};\n\n/**\n * Handles a client error.\n *\n * @api private\n */\n\nSocket.prototype.onerror = function(err){\n  if (this.listeners('error').length) {\n    this.emit('error', err);\n  } else {\n    console.error('Missing error handler on `socket`.');\n    console.error(err.stack);\n  }\n};\n\n/**\n * Called upon closing. Called by `Client`.\n *\n * @param {String} reason\n * @throw {Error} optional error object\n * @api private\n */\n\nSocket.prototype.onclose = function(reason){\n  if (!this.connected) return this;\n  debug('closing socket - reason %s', reason);\n  this.emit('disconnecting', reason);\n  this.leaveAll();\n  this.nsp.remove(this);\n  this.client.remove(this);\n  this.connected = false;\n  this.disconnected = true;\n  delete this.nsp.connected[this.id];\n  this.emit('disconnect', reason);\n};\n\n/**\n * Produces an `error` packet.\n *\n * @param {Object} err error object\n * @api private\n */\n\nSocket.prototype.error = function(err){\n  this.packet({ type: parser.ERROR, data: err });\n};\n\n/**\n * Disconnects this client.\n *\n * @param {Boolean} close if `true`, closes the underlying connection\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.disconnect = function(close){\n  if (!this.connected) return this;\n  if (close) {\n    this.client.disconnect();\n  } else {\n    this.packet({ type: parser.DISCONNECT });\n    this.onclose('server namespace disconnect');\n  }\n  return this;\n};\n\n/**\n * Sets the compress flag.\n *\n * @param {Boolean} compress if `true`, compresses the sending data\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.compress = function(compress){\n  this.flags.compress = compress;\n  return this;\n};\n\n/**\n * Sets the binary flag\n *\n * @param {Boolean} Encode as if it has binary data if `true`, Encode as if it doesnt have binary data if `false`\n * @return {Socket} self\n * @api public\n */\n\n Socket.prototype.binary = function (binary) {\n   this.flags.binary = binary;\n   return this;\n };\n\n/**\n * Dispatch incoming event to socket listeners.\n *\n * @param {Array} event that will get emitted\n * @api private\n */\n\nSocket.prototype.dispatch = function(event){\n  debug('dispatching an event %j', event);\n  var self = this;\n  function dispatchSocket(err) {\n    process.nextTick(function(){\n      if (err) {\n        return self.error(err.data || err.message);\n      }\n      emit.apply(self, event);\n    });\n  }\n  this.run(event, dispatchSocket);\n};\n\n/**\n * Sets up socket middleware.\n *\n * @param {Function} middleware function (event, next)\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.use = function(fn){\n  this.fns.push(fn);\n  return this;\n};\n\n/**\n * Executes the middleware for an incoming event.\n *\n * @param {Array} event that will get emitted\n * @param {Function} last fn call in the middleware\n * @api private\n */\nSocket.prototype.run = function(event, fn){\n  var fns = this.fns.slice(0);\n  if (!fns.length) return fn(null);\n\n  function run(i){\n    fns[i](event, function(err){\n      // upon error, short-circuit\n      if (err) return fn(err);\n\n      // if no middleware left, summon callback\n      if (!fns[i + 1]) return fn(null);\n\n      // go on to next\n      run(i + 1);\n    });\n  }\n\n  run(0);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}