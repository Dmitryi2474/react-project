{"ast":null,"code":"\"use strict\";\n\nvar _ = require(\"./lodash.custom\");\nvar Immutable = require(\"immutable\");\nvar snippetUtils = require(\"./snippet\").utils;\nmodule.exports = {\n  /**\n   *\n   * @this {BrowserSync}\n   * @returns {String}\n   */\n  \"client:js\": function (hooks, data) {\n    var js = snippetUtils.getClientJs(data.port, data.options);\n    return hooks.reduce(function (acc, hook) {\n      if (typeof hook === \"function\") {\n        return acc.concat(hook);\n      }\n      return acc.concat(String(hook));\n    }, [js]);\n  },\n  /**\n   * @this {BrowserSync}\n   * @returns {Array}\n   */\n  \"client:events\": function (hooks, clientEvents) {\n    hooks.forEach(function (hook) {\n      var result = hook(this);\n      if (Array.isArray(result)) {\n        clientEvents = _.union(clientEvents, result);\n      } else {\n        clientEvents.push(result);\n      }\n    }, this);\n    return clientEvents;\n  },\n  /**\n   * @returns {Array}\n   */\n  \"server:middleware\": function (hooks, initial) {\n    initial = initial || [];\n    _.each(hooks, function (hook) {\n      var result = hook(this);\n      if (Array.isArray(result)) {\n        result.forEach(function (res) {\n          if (_.isFunction(res)) {\n            initial = initial.push(res);\n          }\n        });\n      } else {\n        if (_.isFunction(result)) {\n          initial = initial.push(result);\n        }\n      }\n    }, this);\n    return initial;\n  },\n  /**\n   * @param {Array} hooks\n   * @param {Map|List} initial\n   * @param pluginOptions\n   * @returns {any}\n   */\n  \"files:watch\": function (hooks, initial, pluginOptions) {\n    var opts;\n    if (pluginOptions) {\n      opts = Immutable.fromJS(pluginOptions);\n      opts.forEach(function (value, key) {\n        if (!value) {\n          return;\n        }\n        var files = value.get(\"files\");\n        if (files) {\n          var fileArg = require(\"./cli/cli-options\").makeFilesArg(files);\n          if (fileArg) {\n            initial = initial.set(key, Immutable.fromJS(fileArg));\n          }\n        }\n      });\n    }\n    return initial;\n  }\n};","map":{"version":3,"mappings":"AAAA,YAAY;;AAEZ,IAAIA,CAAC,GAAGC,OAAO,CAAC,iBAAiB,CAAC;AAClC,IAAIC,SAAS,GAAGD,OAAO,CAAC,WAAW,CAAC;AACpC,IAAIE,YAAY,GAAGF,OAAO,CAAC,WAAW,CAAC,CAACG,KAAK;AAE7CC,MAAM,CAACC,OAAO,GAAG;EACb;;;;;EAKA,WAAW,EAAE,UAASC,KAAK,EAAEC,IAAI;IAC7B,IAAIC,EAAE,GAAGN,YAAY,CAACO,WAAW,CAACF,IAAI,CAACG,IAAI,EAAEH,IAAI,CAACI,OAAO,CAAC;IAE1D,OAAOL,KAAK,CAACM,MAAM,CAAC,UAASC,GAAG,EAAEC,IAAI;MAClC,IAAI,OAAOA,IAAI,KAAK,UAAU,EAAE;QAC5B,OAAOD,GAAG,CAACE,MAAM,CAACD,IAAI,CAAC;;MAE3B,OAAOD,GAAG,CAACE,MAAM,CAACC,MAAM,CAACF,IAAI,CAAC,CAAC;IACnC,CAAC,EAAE,CAACN,EAAE,CAAC,CAAC;EACZ,CAAC;EACD;;;;EAIA,eAAe,EAAE,UAASF,KAAK,EAAEW,YAAY;IACzCX,KAAK,CAACY,OAAO,CAAC,UAASJ,IAAI;MACvB,IAAIK,MAAM,GAAGL,IAAI,CAAC,IAAI,CAAC;MAEvB,IAAIM,KAAK,CAACC,OAAO,CAACF,MAAM,CAAC,EAAE;QACvBF,YAAY,GAAGlB,CAAC,CAACuB,KAAK,CAACL,YAAY,EAAEE,MAAM,CAAC;OAC/C,MAAM;QACHF,YAAY,CAACM,IAAI,CAACJ,MAAM,CAAC;;IAEjC,CAAC,EAAE,IAAI,CAAC;IAER,OAAOF,YAAY;EACvB,CAAC;EACD;;;EAGA,mBAAmB,EAAE,UAASX,KAAK,EAAEkB,OAAO;IACxCA,OAAO,GAAGA,OAAO,IAAI,EAAE;IAEvBzB,CAAC,CAAC0B,IAAI,CACFnB,KAAK,EACL,UAASQ,IAAI;MACT,IAAIK,MAAM,GAAGL,IAAI,CAAC,IAAI,CAAC;MAEvB,IAAIM,KAAK,CAACC,OAAO,CAACF,MAAM,CAAC,EAAE;QACvBA,MAAM,CAACD,OAAO,CAAC,UAASQ,GAAG;UACvB,IAAI3B,CAAC,CAAC4B,UAAU,CAACD,GAAG,CAAC,EAAE;YACnBF,OAAO,GAAGA,OAAO,CAACD,IAAI,CAACG,GAAG,CAAC;;QAEnC,CAAC,CAAC;OACL,MAAM;QACH,IAAI3B,CAAC,CAAC4B,UAAU,CAACR,MAAM,CAAC,EAAE;UACtBK,OAAO,GAAGA,OAAO,CAACD,IAAI,CAACJ,MAAM,CAAC;;;IAG1C,CAAC,EACD,IAAI,CACP;IAED,OAAOK,OAAO;EAClB,CAAC;EACD;;;;;;EAMA,aAAa,EAAE,UAASlB,KAAK,EAAEkB,OAAO,EAAEI,aAAa;IACjD,IAAIC,IAAI;IAER,IAAID,aAAa,EAAE;MACfC,IAAI,GAAG5B,SAAS,CAAC6B,MAAM,CAACF,aAAa,CAAC;MACtCC,IAAI,CAACX,OAAO,CAAC,UAASa,KAAK,EAAEC,GAAG;QAC5B,IAAI,CAACD,KAAK,EAAE;UACR;;QAEJ,IAAIE,KAAK,GAAGF,KAAK,CAACG,GAAG,CAAC,OAAO,CAAC;QAC9B,IAAID,KAAK,EAAE;UACP,IAAIE,OAAO,GAAGnC,OAAO,CAAC,mBAAmB,CAAC,CAACoC,YAAY,CACnDH,KAAK,CACR;UACD,IAAIE,OAAO,EAAE;YACTX,OAAO,GAAGA,OAAO,CAACa,GAAG,CAACL,GAAG,EAAE/B,SAAS,CAAC6B,MAAM,CAACK,OAAO,CAAC,CAAC;;;MAGjE,CAAC,CAAC;;IAGN,OAAOX,OAAO;EAClB;CACH","names":["_","require","Immutable","snippetUtils","utils","module","exports","hooks","data","js","getClientJs","port","options","reduce","acc","hook","concat","String","clientEvents","forEach","result","Array","isArray","union","push","initial","each","res","isFunction","pluginOptions","opts","fromJS","value","key","files","get","fileArg","makeFilesArg","set"],"sources":["../lib/hooks.js"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}